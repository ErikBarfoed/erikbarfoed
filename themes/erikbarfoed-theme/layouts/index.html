{{ define "main" }}

{{ $posts := (where .Site.RegularPages "Section" "indlaeg").ByDate.Reverse }}
{{ $recentPosts := first 5 $posts }}

{{ if $recentPosts }}
<section class="posts-section">
    {{ range $recentPosts }}
    <article class="post">
        <p class="post-date">{{ time.Format "2. January 2006" .Date }}</p>
        <h2 class="post-title"><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
        <div class="post-content">
            {{ .Content }}
        </div>
    </article>
    {{ end }}
    {{ if gt (len $posts) 5 }}
    <p class="posts-archive-link"><a href="{{ "indlaeg/" | relURL }}">Alle indlæg</a></p>
    {{ end }}
</section>
{{ end }}

{{ $allBooks := (where .Site.RegularPages "Section" "boeger").ByParam "year" | collections.Reverse }}
{{ $featured := index $allBooks 0 }}

<section class="featured-book">
    <div class="book-header">
        <div class="book-cover">
            <a href="{{ $featured.Permalink }}">
                <img src="{{ $featured.Params.cover | relURL }}" alt="{{ $featured.Title }}">
            </a>
        </div>
        <div class="book-info">
            <p class="book-meta">Seneste bog</p>
            <h1><a href="{{ $featured.Permalink }}" style="color: inherit; text-decoration: none;">{{ $featured.Title }}</a></h1>
            {{ with $featured.Params.subtitle }}<p class="book-meta" style="font-size: 1.1rem; margin-bottom: 1rem;">{{ . }}</p>{{ end }}
            <div class="book-description">
                {{ $featured.Summary }}
            </div>
            <a href="{{ $featured.Permalink }}" class="btn">Læs mere</a>
        </div>
    </div>
</section>

{{ $rest := after 1 $allBooks }}
{{ if $rest }}
<section style="margin-top: 3rem;">
    <h2>Alle bøger</h2>
    <div class="books-grid">
        {{ range $rest }}
        <div class="book-card">
            <a href="{{ .Permalink }}">
                <img src="{{ .Params.cover | relURL }}" alt="{{ .Title }}">
            </a>
            <p class="book-card-title">
                <a href="{{ .Permalink }}">{{ .Title }}</a>
            </p>
            <p class="book-card-year">{{ .Params.year }}</p>
        </div>
        {{ end }}
    </div>
</section>
{{ end }}

{{ end }}
